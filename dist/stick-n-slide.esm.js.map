{"version":3,"file":"stick-n-slide.esm.js","sources":["../node_modules/style-inject/dist/style-inject.es.js","../src/index.js"],"sourcesContent":["function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import normalizeWheel from \"normalize-wheel\";\nimport \"./stick-n-slide.scss\";\n\nconst tableScrollPositions = new WeakMap();\n\nconst observeConfig = {\n  childList: true,\n  subtree: true\n};\n\nfunction handleMutations(mutations, observer) {\n  observer.disconnect(); // Prevent any further updates to the DOM from making the observer thrash.\n\n  const table = closest(mutations[0].target, \"sns\");\n\n  mutations.forEach(m => {\n    if (!table.classList.contains(\"sns--pause-mutation\")) {\n      if (m.type === \"childList\") {\n        Array.prototype.slice.call(m.removedNodes).forEach(removedNode => {\n          if (removedNode.classList) {\n            if (m.target.tagName == \"TR\") {\n              // 0) Rebuild entire table TH/TD\n              Array.prototype.slice\n                .call(m.removedNodes)\n                .forEach((removedNode, i) => {\n                  const addedNode = m.addedNodes[i];\n\n                  // Merge DOM attributes\n                  const oldAttrs = removedNode.attributes;\n                  for (let i = oldAttrs.length - 1; i >= 0; i--) {\n                    const attrName = oldAttrs[i].name;\n                    const attrValue = oldAttrs[i].value;\n                    if (attrName === \"style\") {\n                      const oldStyle = (\n                        removedNode.getAttribute(\"style\") || \"\"\n                      ).replace(/;$/, \"\");\n                      addedNode.setAttribute(\n                        \"style\",\n                        `${oldStyle}; ${addedNode.getAttribute(\"style\")}`\n                      );\n                    } else if (attrName === \"class\") {\n                      Array.prototype.slice\n                        .call(removedNode.classList)\n                        .forEach(className => {\n                          addedNode.classList.add(className);\n                        });\n                    } else {\n                      if (addedNode.getAttribute(attrName) === null) {\n                        addedNode.setAttribute(attrName, attrValue);\n                      }\n                    }\n                  }\n\n                  // Build up inner cell and contents\n                  const innerCell = removedNode.firstChild;\n                  const contents = innerCell.firstChild;\n                  while (contents.firstChild) {\n                    contents.removeChild(contents.firstChild);\n                  }\n\n                  while (addedNode.firstChild) {\n                    contents.appendChild(addedNode.firstChild);\n                  }\n\n                  addedNode.appendChild(innerCell);\n                });\n            } else if (removedNode.classList.contains(\"sns__cell-inner\")) {\n              // 1.1 - From scratch\n              m.target.innerCellStyle = removedNode.getAttribute(\"style\");\n            }\n          }\n        });\n        Array.prototype.slice.call(m.addedNodes).forEach(addedNode => {\n          // 1) Rebuild placeholder-cell\n          if (m.target.classList.contains(\"sns__placeholder-cell\")) {\n            if (m.target.innerCellStyle) {\n              // 1.1 - From scratch\n              const innerCell = document.createElement(\"div\");\n              innerCell.setAttribute(\"class\", \"sns__cell-inner\");\n              innerCell.setAttribute(\"style\", m.target.innerCellStyle);\n              delete m.target.innerCellStyle;\n\n              const contents = document.createElement(\"div\");\n              contents.classList.add(\"sns__cell-contents\");\n              contents.appendChild(addedNode);\n\n              innerCell.appendChild(contents);\n              m.target.appendChild(innerCell);\n            } else {\n              // 1.2 - When a direct descendent of placeholder-cell has been created\n              const innerCell = document.createElement(\"div\");\n              innerCell.setAttribute(\"class\", \"sns__cell-inner\");\n\n              const contents = document.createElement(\"div\");\n              contents.classList.add(\"sns__cell-contents\");\n\n              while (m.target.firstChild) {\n                const child = m.target.firstChild;\n                if (\n                  child.classList &&\n                  child.classList.contains(\"sns__cell-inner\")\n                ) {\n                  innerCell.setAttribute(\n                    \"style\",\n                    m.target.firstChild.getAttribute(\"style\")\n                  );\n                  while (child.firstChild.firstChild) {\n                    contents.appendChild(child.firstChild.firstChild);\n                  }\n                  m.target.removeChild(child);\n                } else {\n                  contents.appendChild(child);\n                }\n              }\n\n              innerCell.appendChild(contents);\n\n              m.target.appendChild(innerCell);\n            }\n          }\n\n          // 2) Rebuild cell-inner\n          if (m.target.classList.contains(\"sns__cell-inner\")) {\n            const contents = document.createElement(\"div\");\n            contents.classList.add(\"sns__cell-contents\");\n\n            if (\n              !Array.prototype.slice\n                .call(m.target.children)\n                .find(node => node.classList.contains(\"sns__cell-contents\"))\n            ) {\n              // 2.1 - Build from scratch\n              contents.appendChild(addedNode);\n              m.target.appendChild(contents);\n            } else {\n              // 2.2 - When a direct descendent of cell-inner has been created\n              while (m.target.firstChild) {\n                const child = m.target.firstChild;\n                if (\n                  child.classList &&\n                  child.classList.contains(\"sns__cell-contents\")\n                ) {\n                  while (child && child.firstChild) {\n                    contents.appendChild(child.firstChild);\n                  }\n                  m.target.removeChild(child);\n                } else {\n                  contents.appendChild(child);\n                }\n              }\n              m.target.appendChild(contents);\n            }\n          }\n        });\n      }\n    }\n  });\n\n  setInnerCellHeights(table);\n\n  requestAnimationFrame(() => {\n    observer.observe(table, observeConfig);\n  });\n}\n\nfunction closest(elem, classMatcher) {\n  if (elem.classList) {\n    if (elem.classList.contains(classMatcher)) {\n      return elem;\n    } else {\n      if (elem.parentElement) {\n        return closest(elem.parentElement, classMatcher);\n      } else {\n        return;\n      }\n    }\n  } else {\n    return closest(elem.parentElement, classMatcher);\n  }\n}\n\nfunction altSide(side) {\n  switch (side) {\n    case \"Left\":\n      return \"Right\";\n    case \"Right\":\n      return \"Left\";\n    case \"Top\":\n      return \"Bottom\";\n    case \"Bottom\":\n      return \"Top\";\n  }\n}\n\nfunction wheelHandler({\n  table,\n  wrapper,\n  stickyElems,\n  pixelX,\n  pixelY,\n  scrollLeft,\n  scrollTop,\n  scrollWidth,\n  scrollHeight,\n  clientWidth,\n  clientHeight,\n  showShadow,\n  callback,\n  isIE11\n}) {\n  const maxWidth = scrollWidth - clientWidth;\n  const maxHeight = scrollHeight - clientHeight;\n  let newX = scrollLeft + pixelX;\n  let newY = scrollTop + pixelY;\n  if (newX >= maxWidth) {\n    newX = maxWidth;\n  }\n  if (newX <= 0) {\n    newX = 0;\n  }\n  if (newY >= maxHeight) {\n    newY = maxHeight;\n  }\n  if (newY <= 0) {\n    newY = 0;\n  }\n\n  if (isIE11) {\n    positionStickyElements(table, stickyElems, showShadow, newX, newY);\n    wrapper.scrollLeft = newX;\n    wrapper.scrollTop = newY;\n  } else {\n    wrapper.scrollLeft = newX;\n    wrapper.scrollTop = newY;\n\n    // Modern browsers have a nasty habit of setting scrollLeft/scrollTop not to the actual integer value you specified, but\n    // rather to a sub-pixel value that is \"pretty close\" to what you specified. To work around that, set the scroll value\n    // and then use that same scroll value as the left/top offset for the stuck elements.\n    positionStickyElements(\n      table,\n      stickyElems,\n      showShadow,\n      wrapper.scrollLeft,\n      wrapper.scrollTop\n    );\n  }\n  if (callback) {\n    callback(newX, newY);\n  }\n}\n\nfunction calculateShadowOffset(value) {\n  value = Math.ceil(value / 10);\n  if (value > 2) {\n    return 2;\n  } else {\n    return value;\n  }\n}\n\nfunction calculateShadowColor(cell, opacity) {\n  const rgb = window\n    .getComputedStyle(cell)\n    .backgroundColor.replace(\"rgb(\", \"\")\n    .replace(\")\", \"\")\n    .split(\",\")\n    .map(value => Math.round(parseInt(value, 10) * 0.3))\n    .join(\",\");\n  return `rgba(${rgb},${opacity})`;\n}\n\nfunction setCellTransforms({ cell, showShadow, scrollLeft, scrollTop }) {\n  let transforms = [];\n  if (\n    cell.classList.contains(\"sns--is-stuck-y\") ||\n    cell.classList.contains(\"sns--is-stuck\")\n  ) {\n    transforms.push(`translateY(${scrollTop}px)`);\n  }\n  if (\n    cell.classList.contains(\"sns--is-stuck-x\") ||\n    cell.classList.contains(\"sns--is-stuck\")\n  ) {\n    transforms.push(`translateX(${scrollLeft}px)`);\n  }\n  cell.style.transform = transforms.join(\" \");\n  positionShadow(cell, showShadow, scrollLeft, scrollTop);\n}\n\nfunction positionStickyElements(\n  table,\n  elems,\n  showShadow,\n  scrollLeft = 0,\n  scrollTop = 0\n) {\n  requestAnimationFrame(() => {\n    elems.forEach(cellsOfType => {\n      for (let cell of cellsOfType) {\n        setCellTransforms({ cell, showShadow, scrollLeft, scrollTop });\n      }\n    });\n    tableScrollPositions.set(table, { left: scrollLeft, top: scrollTop });\n    table.dispatchEvent(\n      new CustomEvent(\"sns:scroll\", {\n        detail: { scrollLeft, scrollTop }\n      })\n    );\n  });\n}\n\nfunction positionShadow(cell, showShadow, offsetX, offsetY) {\n  if (!showShadow) return;\n  const shadowColor = calculateShadowColor(cell, 0.4);\n  let xShadow = \"0 0\";\n  let yShadow = \"0 0\";\n  let shadow;\n  if (offsetY) {\n    shadow = calculateShadowOffset(offsetY);\n    yShadow = `0 ${shadow}px ${shadowColor}`;\n  }\n  if (offsetX) {\n    shadow = calculateShadowOffset(offsetX);\n    xShadow = `${shadow}px 0 ${shadowColor}`;\n  }\n  cell.style.setProperty(\"--x-shadow\", xShadow);\n  cell.style.setProperty(\"--y-shadow\", yShadow);\n}\n\nfunction scrollHandler(table, stickyElems, wrapper, showShadow, callback) {\n  updateScrollPosition(table, stickyElems, wrapper, showShadow, callback);\n}\n\nfunction updateScrollPosition(\n  table,\n  stickyElems,\n  wrapper,\n  showShadow,\n  callback\n) {\n  positionStickyElements(\n    table,\n    stickyElems,\n    showShadow,\n    wrapper.scrollLeft,\n    wrapper.scrollTop\n  );\n  if (callback) {\n    callback(wrapper.scrollLeft, wrapper.scrollTop);\n  }\n}\n\nfunction buildInnerCell(cell) {\n  const cellStyles = window.getComputedStyle(cell);\n  cell.classList.add(\"sns__placeholder-cell\");\n  let innerCell = document.createElement(\"div\");\n  innerCell.setAttribute(\"class\", \"sns__cell-inner\");\n  let cellContents = document.createElement(\"div\");\n  cellContents.setAttribute(\"class\", \"sns__cell-contents\");\n  let setStyles = true;\n  while (cell.firstChild) {\n    cellContents.appendChild(cell.firstChild);\n    if (\n      cell.firstChild &&\n      cell.firstChild.classList &&\n      cell.firstChild.classList.contains(\"sns__cell-inner\")\n    ) {\n      while (cell.firstChild.firstChild.firstChild) {\n        cellContents.appendChild(cell.firstChild.firstChild.firstChild);\n      }\n      innerCell.setAttribute(\"style\", cell.firstChild.getAttribute(\"style\"));\n      innerCell.style.height = \"\";\n      if (\"removeNode\" in cell.firstChild) {\n        // IE11 specific method.\n        cell.firstChild.removeNode(true);\n      } else {\n        // All other browsers ... technically not needed (since this code path only deals with IE11) but good to have for testing in other browsers.\n        cell.firstChild.remove();\n      }\n      setStyles = false;\n    }\n  }\n  innerCell.appendChild(cellContents);\n  cell.innerHTML = \"\";\n  cell.appendChild(innerCell);\n\n  if (setStyles) {\n    [\"padding\", \"border\"].forEach(property => {\n      [\"Top\", \"Right\", \"Bottom\", \"Left\"].forEach(side => {\n        if (property === \"border\") {\n          const borderWidth = cellStyles[`border${side}Width`];\n          innerCell.style[\n            `margin${altSide(side)}`\n          ] = `calc(-1 * ${borderWidth})`;\n\n          [\"Width\", \"Color\", \"Style\"].forEach(attr => {\n            const value = cellStyles[`${property}${side}${attr}`];\n            innerCell.style[`${property}${side}${attr}`] = value;\n          });\n        } else {\n          innerCell.style[`${property}${side}`] =\n            cellStyles[`${property}${side}`];\n        }\n      });\n      cell.style[property] = \"0\";\n    });\n\n    innerCell.style.alignItems = verticalAlignment(cellStyles.verticalAlign);\n  }\n}\n\n// Convert regular `vertical-align` CSS into flexbox friendly alternative.\nfunction verticalAlignment(value) {\n  switch (value) {\n    case \"middle\":\n      return \"center\";\n    case \"top\":\n      return \"start\";\n    case \"bottom\":\n      return \"end\";\n    case \"baseline\":\n      return \"baseline\";\n    default:\n      return \"\";\n  }\n}\n\nfunction setInnerCellHeights(table) {\n  const stickyElems = table.getElementsByClassName(\n    \"sns--is-stuck sns--is-stuck-y sns--is-stuck-x\"\n  );\n  stickyElems.forEach(cell => {\n    cell.style.height = \"\";\n  });\n  requestAnimationFrame(() => {\n    stickyElems.forEach(cell => {\n      cell.style.height = `${cell.getBoundingClientRect().height}px`;\n    });\n  });\n}\n\nfunction processCell({\n  cell,\n  isFirefox,\n  isIE11,\n  scrollPositions: { left, top },\n  showShadow\n}) {\n  if (isIE11) {\n    // Behavior for IE11.\n    buildInnerCell(cell);\n  } else {\n    // Everything other than IE11.\n    const cellStyles = window.getComputedStyle(cell);\n    [\"Top\", \"Right\", \"Bottom\", \"Left\"].forEach(side => {\n      [\"Width\"].forEach(property => {\n        let borderWidth = cellStyles[`border${side}${property}`];\n        if (isFirefox) {\n          const value = borderWidth.match(/([^a-z%]+)([a-z%]+)/);\n          borderWidth = `${Math.round(value[1])}${value[2]}`;\n        }\n        cell.style[`margin${side}`] = `-${borderWidth}`;\n      });\n    });\n  }\n  setCellTransforms({ cell, scrollLeft: left, scrollTop: top, showShadow });\n  // cell.style.transform = `translateX(${left}px) translateY(${top}px)`;\n}\n\nexport default function(elems, options = {}) {\n  const { showShadow, callback } = options;\n  // Must test for FF, because it does some seriously horrible things to the table layout.\n  const userAgent = navigator.userAgent.toLowerCase();\n  const isFirefox = userAgent.indexOf(\"firefox\") > -1;\n  const isIE = userAgent.indexOf(\"trident\") > -1;\n  const isIEedge = userAgent.indexOf(\"edge\") > -1;\n  const isIE11 = isIE && !isIEedge;\n\n  // Convert a jQuery object to an array, or convert a single element to an array.\n  if (typeof elems.toArray === \"function\") {\n    elems = elems.toArray();\n  } else if (!Array.isArray(elems)) {\n    elems = [elems];\n  }\n\n  elems.forEach(table => {\n    if (!table.StickNSlide) {\n      table.StickNSlide = {};\n      const wrapper = table.parentElement;\n\n      wrapper.addEventListener(\n        \"wheel\",\n        event => {\n          const normalized = normalizeWheel(event);\n          wheelEventTriggered = true;\n          const { pixelX, pixelY } = normalized;\n          const {\n            scrollLeft,\n            scrollTop,\n            scrollWidth,\n            scrollHeight,\n            clientWidth,\n            clientHeight\n          } = wrapper;\n\n          const opts = {\n            table,\n            wrapper,\n            stickyElems,\n            pixelX,\n            pixelY,\n            scrollLeft,\n            scrollTop,\n            scrollWidth,\n            scrollHeight,\n            clientWidth,\n            clientHeight,\n            showShadow,\n            callback,\n            isIE11\n          };\n          console.log(stickyElems.map(coll => Array.from(coll)).flat().length);\n\n          if (isIE || isIEedge) {\n            event.preventDefault();\n            event.stopPropagation();\n            wheelHandler(opts);\n          } else {\n            event.preventDefault();\n            wheelHandler(opts);\n          }\n        },\n        { capture: true }\n      );\n\n      wrapper.addEventListener(\"scroll\", () => {\n        if (wheelEventTriggered) {\n          wheelEventTriggered = false;\n        } else {\n          scrollHandler(table, stickyElems, wrapper, showShadow, callback);\n        }\n      });\n\n      // --------------------\n\n      const stickyElems = [\n        \"sns--is-stuck\",\n        \"sns--is-stuck-y\",\n        \"sns--is-stuck-x\"\n      ].reduce((acc, className) => {\n        acc.push(table.getElementsByClassName(className));\n        return acc;\n      }, []);\n\n      if (getComputedStyle(wrapper).position === \"static\") {\n        wrapper.style.position = \"relative\";\n      }\n      table.classList.add(\"sns\");\n      table.style.position = \"relative\";\n\n      [\"Top\", \"Left\"].forEach(side => {\n        if (table[`offset${side}`] > 0) {\n          table.style[side.toLowerCase()] = `-${table[`offset${side}`]}px`;\n        }\n      });\n\n      // stickyElems.forEach(cell => {\n      //   if (isIE11()) {\n      //     // Behavior for IE11.\n      //     buildInnerCell(cell);\n      //   } else {\n      //     // Everything other than IE11.\n      //     const cellStyles = window.getComputedStyle(cell);\n      //     [\"Top\", \"Right\", \"Bottom\", \"Left\"].forEach(side => {\n      //       [\"Width\"].forEach(property => {\n      //         let borderWidth = cellStyles[`border${side}${property}`];\n      //         if (isFirefox) {\n      //           const value = borderWidth.match(/([^a-z%]+)([a-z%]+)/);\n      //           borderWidth = `${Math.round(value[1])}${value[2]}`;\n      //         }\n      //         cell.style[`margin${side}`] = `-${borderWidth}`;\n      //       });\n      //     });\n      //   }\n      // });\n\n      const scrollPositions = {\n        left: wrapper.scrollLeft,\n        top: wrapper.scrollTop\n      };\n      tableScrollPositions.set(table, scrollPositions);\n\n      stickyElems.forEach(cellsOfType => {\n        for (let cell of cellsOfType) {\n          processCell({ cell, isFirefox, isIE11, scrollPositions, showShadow });\n        }\n      });\n\n      // processCells(stickyElems, { isFirefox, isIE11: isIE11() });\n\n      // Variable that tracks whether \"wheel\" event was called.\n      // Prevents both \"wheel\" and \"scroll\" events being triggered simultaneously.\n      let wheelEventTriggered = false;\n\n      // Set initial position of elements to 0.\n      requestAnimationFrame(() => {\n        // positionStickyElements(table, stickyElems, showShadow, isIE11);\n        positionStickyElements(\n          table,\n          stickyElems,\n          showShadow,\n          wrapper.scrollLeft,\n          wrapper.scrollTop\n        );\n        if (isIE11) {\n          setInnerCellHeights(table);\n        }\n\n        // ----------------------------\n        // Handle IE11 mutations to the table cells.\n        requestAnimationFrame(() => {\n          if (isIE && !isIEedge) {\n            let observer = new MutationObserver(handleMutations);\n            observer.observe(table, observeConfig);\n          } else {\n            new MutationObserver(mutations => {\n              const { left, top } = tableScrollPositions.get(table);\n              mutations.forEach(mutation => {\n                const cell = mutation.target;\n                debugger;\n                const classList = cell.classList;\n                if (\n                  classList.contains(\"sns--is-stuck\") ||\n                  classList.contains(\"sns--is-stuck-x\") ||\n                  classList.contains(\"sns--is-stuck-y\")\n                ) {\n                  processCell({\n                    cell,\n                    isFirefox,\n                    isIE11,\n                    scrollPositions: tableScrollPositions.get(table),\n                    showShadow\n                  });\n                } else {\n                  cell.style.margin = \"\";\n                  cell.style.transform = \"\";\n                }\n              });\n            }).observe(table, {\n              // childList: true,\n              subtree: true,\n              attributes: true,\n              attributeFilter: [\"class\"]\n            });\n          }\n        });\n        // ============================\n      });\n    }\n    return;\n  });\n\n  window.addEventListener(\"resize\", () => {\n    requestAnimationFrame(() => {\n      elems.forEach(table => {\n        if (isIE11) {\n          setInnerCellHeights(table);\n        }\n      });\n    });\n  });\n}\n\nconst foo = {\n  init: table => {\n    table = table;\n  }\n};\n"],"names":["styleInject","css","ref","insertAt","document","head","getElementsByTagName","style","createElement","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","tableScrollPositions","WeakMap","observeConfig","childList","subtree","handleMutations","mutations","observer","disconnect","table","closest","target","forEach","m","classList","contains","Array","prototype","slice","call","removedNodes","removedNode","tagName","i","addedNode","addedNodes","oldAttrs","attributes","length","attrName","name","attrValue","value","oldStyle","getAttribute","replace","setAttribute","className","add","innerCell","contents","removeChild","innerCellStyle","child","children","find","node","setInnerCellHeights","requestAnimationFrame","observe","elem","classMatcher","parentElement","altSide","side","wheelHandler","wrapper","stickyElems","pixelX","pixelY","scrollLeft","scrollTop","scrollWidth","scrollHeight","clientWidth","clientHeight","showShadow","callback","isIE11","maxWidth","maxHeight","newX","newY","positionStickyElements","calculateShadowOffset","Math","ceil","calculateShadowColor","cell","opacity","rgb","window","getComputedStyle","backgroundColor","split","map","round","parseInt","join","setCellTransforms","transforms","push","transform","positionShadow","elems","cellsOfType","set","left","top","dispatchEvent","CustomEvent","detail","offsetX","offsetY","shadowColor","xShadow","yShadow","shadow","setProperty","scrollHandler","updateScrollPosition","buildInnerCell","cellStyles","cellContents","setStyles","height","removeNode","remove","innerHTML","property","borderWidth","attr","alignItems","verticalAlignment","verticalAlign","getElementsByClassName","getBoundingClientRect","processCell","isFirefox","scrollPositions","match","options","userAgent","navigator","toLowerCase","indexOf","isIE","isIEedge","toArray","isArray","StickNSlide","addEventListener","event","normalized","normalizeWheel","wheelEventTriggered","opts","console","log","coll","from","flat","preventDefault","stopPropagation","capture","reduce","acc","position","MutationObserver","get","mutation","margin","attributeFilter"],"mappings":"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"}